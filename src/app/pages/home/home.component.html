<app-navbar></app-navbar>

<div class="home-container">
  <header class="home-header">
    <h1>Bienvenido a Healthy Truck</h1>
    <p>Tu plataforma para cuidar tu cami√≥n</p>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  </header>

  <!-- Estad√≠sticas -->
  <section class="home-stats">
    <div class="stat" *ngFor="let stat of stats">
      <h3>{{ stat.label }}</h3>
      <p>{{ stat.value }}</p>
    </div>
  </section>

  <!-- Botones para cambiar de vista -->
  <div class="view-buttons">
    <button (click)="switchView('calendar')" [disabled]="vistaActual === 'calendar'">Vista Calendario</button>
    <button (click)="switchView('list')" [disabled]="vistaActual === 'list'">Vista Lista</button>
  </div>

  <!-- Calendario o lista, seg√∫n la vista actual -->
  <div *ngIf="vistaActual === 'calendar'" class="calendar-container">
    <full-calendar #calendar [options]="calendarOptions"></full-calendar>
  </div>

  <div *ngIf="vistaActual === 'list'" class="list-container">

    <!-- Lista de camiones -->
<section class="fleet-container">
  <div class="truck-card" *ngFor="let camion of camiones">
    <div class="card-header">
      <h3>{{ camion.nombre }}</h3>
      <span [ngClass]="{
        'badge badge-green': camion.estado === 'activo',
        'badge badge-blue': camion.estado === 'en mantencion'
      }">{{ camion.estado }}</span>
    </div>
    <p><strong>Patente:</strong> {{ camion.patente }}</p>
    <p><strong>A√±o:</strong> {{ camion.anio }}</p>
    <p><strong>Alertas:</strong> <span class="alert-count">{{ camion.alertas }}</span></p>
    <p><span class="icon green">‚úî</span> √öltima mantenci√≥n: {{ camion.ultimaMantencion }}</p>
    <p><span class="icon blue">üïì</span> Pr√≥xima mantenci√≥n: {{ camion.proximaMantencion }}</p>
    <div class="progress-info">
      <p>Progreso hasta pr√≥xima mantenci√≥n:</p>
      <div class="progress-bar">
        <div class="progress-fill"
             [ngClass]="{
               'red': camion.progreso >= 90,
               'green': camion.progreso < 90,
               'black': camion.progreso > 100
             }"
             [style.width.%]="camion.progreso"></div>
      </div>
      <div class="progress-labels">
        <span>{{ camion.kmActual }} km</span>
        <span>{{ camion.kmMeta }} km</span>
      </div>
    </div>
    <button class="details-btn" (click)="verDetallesCamion(camion)">Ver Detalles</button>
  </div>
</section>

    <!-- Historial de mantenciones -->
    <section class="maintenance-list">
      <div class="section-header">
        <h2>√öltimas Mantenciones</h2>
        <button class="btn-ver-completo" (click)="verHistorialCompleto()">
          Ver Historial Completo
        </button>
      </div>
      <div *ngIf="historialMantenciones.length > 0; else sinHistorial">
        <div class="maintenance-card historial-card"
             *ngFor="let mantencion of historialMantenciones">
          <div class="historial-header">
            <span class="historial-icon">üîß</span>
            <div class="fecha-hora">
              <strong>{{ mantencion.fecha.split(' ')[0] }}</strong>
              <span class="hora">{{ mantencion.fecha.split(' ')[1] }}</span>
            </div>
          </div>
          <p><strong>Cami√≥n:</strong> {{ mantencion.camion }} ({{ mantencion.patente }})</p>
          <p><strong>Mantenci√≥n:</strong> {{ mantencion.nombre }}</p>
          <p><strong>Acci√≥n:</strong> {{ mantencion.accion }}</p>
          <p><strong>Kilometraje:</strong> {{ mantencion.kilometraje }} km</p>
        </div>
      </div>
      <ng-template #sinHistorial>
        <div class="no-history">
          <p>No hay historial de mantenciones registrado.</p>
        </div>
      </ng-template>
    </section>

    <!-- Lista de alertas -->
    <section class="alert-list">
      <h2>Alertas</h2>
      <div class="alert-card" *ngFor="let alerta of alertas">
        <div class="alert-header">
          <h3>{{ alerta.camion }}</h3>
          <span class="status-badge"
                [ngClass]="{
                  'pendiente': alerta.estado === 'Pendiente',
                  'reconocida': alerta.estado === 'Reconocida'
                }">{{ alerta.estado }}</span>
        </div>
        <p><strong>Tipo:</strong> {{ alerta.tipo }}</p>
        <p><strong>Descripci√≥n:</strong> {{ alerta.descripcion }}</p>
        <p><strong>Fecha l√≠mite:</strong> {{ alerta.fechaLimite }}</p>
        <p *ngIf="alerta.km"><strong>KM actual/l√≠mite:</strong> {{ alerta.km }}</p>
        <div class="alert-type"
             [ngClass]="{
               'advertencia': alerta.nivel === 'Advertencia',
               'critica': alerta.nivel === 'Cr√≠tica',
               'normal': alerta.nivel === 'Normal'
             }">
          {{ alerta.icono }} {{ alerta.nivel }}
        </div>
        <div class="alert-buttons">
          <button class="details" (click)="verDetalles(alerta)">Ver Detalles</button>
          <button class="primary" (click)="reconocerAlerta(alerta)">Reconocer</button>
        </div>
      </div>
    </section>

  </div>
</div>

<footer class="home-footer">
    <p>&copy; 2025 Healthy Truck. Todos los derechos reservados.</p>
</footer>
